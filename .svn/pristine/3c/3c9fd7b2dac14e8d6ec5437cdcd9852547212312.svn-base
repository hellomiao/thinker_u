<!-- 重点参数：renderOptions -->

<?php

$this->title='司机轨迹';
$this->params['breadcrumbs'][] = ['label' => '考勤列表', 'url' => ['index']];
$this->params['breadcrumbs'][] = $this->title;
?>


<section class="content">
    <div class="row">


    <div class="col-xs-12">

        <div id="container" style="width: 100%;height:800px"  class="map" tabindex="0"></div>

    </div>

    </div>
    </section>



<script type="text/javascript" src='//webapi.amap.com/maps?v=1.3&key=<?php echo Yii::$app->params['mapkey'];?>'></script>
<!-- UI组件库 1.0 -->
<script src="//webapi.amap.com/ui/1.0/main.js?v=1.0.10"></script>
<?php \common\widgets\JsBlock::begin() ?>
<script type="text/javascript">
    //创建地图
    var map = new AMap.Map('container', {
        zoom: 4
    });


    var json = '<?php echo json_encode($location);?>';

    json=JSON.parse(json);



    AMapUI.load(['ui/misc/PathSimplifier'], function(PathSimplifier) {


        if (!PathSimplifier.supportCanvas) {
            alert('当前环境不支持 Canvas！');
            return;
        }

        var pathSimplifierIns = new PathSimplifier({
            zIndex: 100,
            map: map, //所属的地图实例
            getPath: function(pathData, pathIndex) {
                //返回轨迹数据中的节点信息，[AMap.LngLat, AMap.LngLat...] 或者 [[lng,lat],[lng,lat]...]
                return pathData.path;
            },
            getHoverTitle: function(pathData, pathIndex, pointIndex) {
                //返回鼠标悬停时显示的信息
                if (pointIndex >= 0) {
                    //鼠标悬停在某个轨迹节点上
                    return pathData.name + '，点:' + pointIndex + '/' + pathData.path.length;
                }
                //鼠标悬停在节点之间的连线上
                return pathData.name + '，点数量' + pathData.path.length;
            },
            renderOptions: {
                //轨迹线的样式
                pathLineStyle: {
                    strokeStyle: 'red',
                    lineWidth: 6,
                    dirArrowStyle: true
                }
            }
        });

        //这里构建两条简单的轨迹，仅作示例
        pathSimplifierIns.setData([{
            name: '司机轨迹',
            path: json
        }]);


    });


</script>
<?php \common\widgets\JsBlock::end() ?>
